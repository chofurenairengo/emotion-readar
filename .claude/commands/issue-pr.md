---
description: Issue実装後のコミット、プッシュ、PR作成を一括実行。PRはテンプレートに沿って作成。
---

# Issue PR Command

Issue駆動開発フローの最終フェーズ。コミット→プッシュ→PR作成を1つのコマンドで実行。

## 使用方法

```
/issue-pr #<issue番号>
/issue-pr <issue番号>
```

## 前提条件

- `/issue #XX` でworktreeが作成済み
- 実装・レビューが完了済み
- 変更がステージングまたはワーキングディレクトリにある

## 実行フロー

### Step 1: 変更確認

```bash
git status
git diff --stat
```

変更内容を確認し、コミットメッセージとPR内容を決定。

### Step 2: コミット作成

```bash
git add .
git commit -m "feat: #XX [実装内容の要約]"
```

**コミットメッセージフォーマット**:
- `feat: #XX [機能追加の場合]`
- `fix: #XX [バグ修正の場合]`
- `refactor: #XX [リファクタリングの場合]`

### Step 3: プッシュ

```bash
git push -u origin feature/XX
```

### Step 4: PR作成

```bash
gh pr create --title "#XX feat: [実装内容]" --body "$(cat <<'EOF'
## issueの番号
close #XX

## やったこと
- [変更内容1]
- [変更内容2]

## 動作確認
- [テスト方法と結果]

## その他
- [レビュワーへの参考情報]
EOF
)"
```

### Step 5: worktree削除

```bash
# メインディレクトリに戻る
cd ..

# worktreeを削除
git worktree remove <番号>
```

worktree削除後、メインブランチに戻る。

## PRフォーマット

### タイトル

```
#XX feat: [実装内容の要約]
```

例:
- `#42 feat: ユーザー認証機能を追加`
- `#15 fix: ログイン時のエラーハンドリングを修正`

### 本文

```markdown
## issueの番号
close #XX

## やったこと
- [変更内容を箇条書きで]
- UIの変更がある場合はスクリーンショットを添付

## 動作確認
- [どのようなテストを行ったか]
- [結果はどうだったか]

## その他
- [レビュワーへの参考情報]
- [実装上の懸念点や注意点]
```

## 自動生成内容

コマンド実行時に以下を自動生成:

1. **コミットメッセージ**: `git diff`から変更内容を要約
2. **PRタイトル**: Issue番号 + プレフィックス + 要約
3. **やったこと**: 変更ファイル一覧と概要
4. **動作確認**: 基本的なテスト項目

## 引数

$ARGUMENTS:
- `#<番号>` または `<番号>` - 対象issueの番号

## エラー時の対応

### 未コミットの変更がない
```
→ 実装が完了しているか確認
→ git status で状態確認
```

### プッシュ失敗
```
→ リモートブランチの状態確認
→ git pull --rebase で同期
```

### PR作成失敗
```
→ gh auth status で認証確認
→ リポジトリ権限確認
```

## 出力例

```
ISSUE #42 PR作成フロー
======================

Step 1: 変更確認
----------------
変更ファイル: 5個
追加行数: +120
削除行数: -30

Step 2: コミット作成
--------------------
コミットメッセージ: feat: #42 ユーザー認証機能を追加

Step 3: プッシュ
----------------
ブランチ: feature/42
リモート: origin/feature/42

Step 4: PR作成
--------------
タイトル: #42 feat: ユーザー認証機能を追加
URL: https://github.com/owner/repo/pull/123

Step 5: worktree削除
--------------------
worktree: 42 を削除
メインディレクトリに戻りました

完了！
```

## 関連コマンド

- `/issue #XX` - Issue駆動開発フロー開始
- `/code-review` - コードレビュー実行
